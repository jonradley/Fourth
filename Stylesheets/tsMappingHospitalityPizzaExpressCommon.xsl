<?xml version="1.0" encoding="UTF-8"?>
<!--======================================================================================
Overview

Pizza Express UK common script, which holds the Company Code translation logic.
==========================================================================================
 Module History
==========================================================================================
 Version
==========================================================================================
 Date				| Name				| Description of modification
==========================================================================================
 14/04/2016	| Jose Miguel	| FB10911 - Refactor
==========================================================================================
 24/08/2016	| Jose Miguel	| FB11269 - Adding new sites
==========================================================================================
 12/09/2016	| Jose Miguel	| FB11292 - Removing default value for the company
==========================================================================================
15/11/2016	| Jose Miguel	| FB11398 - Adding new sites (2)
==========================================================================================
03/01/2017	| Moty Dimant	| FB11458 - Adding two new sites, PE Gretna and PE Poynton
==========================================================================================
18/01/2017	| Moty Dimant	| FB11488 - Adding two new sites, PE Formby and IM Dublin
==========================================================================================
15/03/2017	| Moty Dimant	| FB11641 - Addition of further Company Codes. Please see FB case for details.
==========================================================================================-->

<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:js="http://www.abs-ltd.com/dummynamespaces/javascript">
	<msxsl:script language="JScript" implements-prefix="js"><![CDATA[ 
	// While we do not have the CompanyCode implemented in R9 any new sites will be translated from the SiteCode
	var mapSiteCodeToCompanyCode =
	{
		111 : '00010',
		121 : '00010',
		131 : '00010',
		141 : '00010',
		161 : '00010',
		171 : '00010',
		191 : '00010',
		201 : '00010',
		211 : '00010',
		221 : '00010',
		231 : '00010',
		241 : '00010',
		251 : '00010',
		261 : '00010',
		271 : '00010',
		281 : '00010',
		301 : '00010',
		311 : '00010',
		321 : '00010',
		331 : '00010',
		341 : '00010',
		351 : '00010',
		361 : '00010',
		371 : '00010',
		381 : '00010',
		391 : '00010',
		401 : '00010',
		411 : '00010',
		421 : '00010',
		431 : '00010',
		441 : '00010',
		451 : '00010',
		461 : '00010',
		471 : '00010',
		481 : '00010',
		491 : '00010',
		501 : '00010',
		511 : '00010',
		521 : '00010',
		531 : '00010',
		541 : '00010',
		551 : '00010',
		561 : '00010',
		571 : '00010',
		581 : '00010',
		591 : '00010',
		601 : '00010',
		611 : '00010',
		621 : '00010',
		631 : '00010',
		641 : '00010',
		651 : '00010',
		671 : '00010',
		691 : '00010',
		701 : '00010',
		711 : '00010',
		721 : '00010',
		731 : '00010',
		741 : '00010',
		751 : '00010',
		761 : '00010',
		771 : '00010',
		781 : '00010',
		791 : '00010',
		801 : '00010',
		811 : '00010',
		821 : '00010',
		831 : '00010',
		841 : '00010',
		851 : '00010',
		861 : '00010',
		871 : '00010',
		881 : '00010',
		891 : '00010',
		911 : '00010',
		921 : '00010',
		931 : '00010',
		941 : '00010',
		951 : '00010',
		961 : '00010',
		971 : '00010',
		981 : '00010',
		1001 : '00010',
		1021 : '00010',
		1031 : '00010',
		1041 : '00010',
		1051 : '00010',
		1061 : '00010',
		1081 : '00010',
		1091 : '00010',
		1101 : '00010',
		1111 : '00010',
		1121 : '00010',
		1131 : '00010',
		1141 : '00010',
		1181 : '00010',
		1191 : '00010',
		1201 : '00010',
		1211 : '00010',
		1221 : '00010',
		1231 : '00010',
		1241 : '00010',
		1261 : '00010',
		1271 : '00010',
		1281 : '00010',
		1291 : '00010',
		1301 : '00010',
		1311 : '00010',
		1321 : '00010',
		1351 : '00010',
		1371 : '00010',
		1381 : '00010',
		1391 : '00010',
		1401 : '00010',
		1411 : '00010',
		1421 : '00010',
		1431 : '00010',
		1441 : '00010',
		1451 : '00010',
		1461 : '00010',
		1471 : '00010',
		1481 : '00010',
		1501 : '00010',
		1511 : '00010',
		1521 : '00010',
		1531 : '00010',
		1541 : '00010',
		1551 : '00010',
		1561 : '00010',
		1571 : '00010',
		1581 : '00010',
		1601 : '00010',
		1611 : '00010',
		1631 : '00010',
		1641 : '00010',
		1651 : '00010',
		1671 : '00010',
		1681 : '00010',
		1691 : '00010',
		1711 : '00010',
		1721 : '00010',
		1731 : '00010',
		1741 : '00010',
		1751 : '00010',
		1761 : '00010',
		1771 : '00010',
		1781 : '00010',
		1791 : '00010',
		1801 : '00010',
		1811 : '00010',
		1821 : '00010',
		1831 : '00010',
		1841 : '00010',
		1851 : '00010',
		1861 : '00010',
		1871 : '00010',
		1881 : '00010',
		1891 : '00010',
		1901 : '00010',
		1911 : '00010',
		1921 : '00010',
		1931 : '00010',
		1941 : '00010',
		1951 : '00010',
		1961 : '00010',
		1971 : '00010',
		1981 : '00010',
		1991 : '00010',
		2011 : '00010',
		2021 : '00010',
		2031 : '00010',
		2041 : '00010',
		2051 : '00010',
		2061 : '00010',
		2071 : '00010',
		2081 : '00010',
		2091 : '00010',
		2101 : '00010',
		2111 : '00010',
		2121 : '00010',
		2131 : '00010',
		2141 : '00010',
		2151 : '00010',
		2161 : '00010',
		2171 : '00010',
		2191 : '00010',
		2211 : '00010',
		2251 : '00010',
		2271 : '00010',
		2281 : '00010',
		2291 : '00010',
		2311 : '00010',
		2321 : '00010',
		2331 : '00010',
		2341 : '00010',
		2351 : '00010',
		2381 : '00010',
		2391 : '00010',
		2401 : '00010',
		2431 : '00010',
		2441 : '00010',
		2451 : '00010',
		2461 : '00010',
		2471 : '00010',
		2491 : '00010',
		2511 : '00010',
		2521 : '00010',
		2531 : '00010',
		2541 : '00010',
		2551 : '00010',
		2561 : '00010',
		2571 : '00010',
		2591 : '00010',
		2601 : '00010',
		2611 : '00010',
		2631 : '00010',
		2641 : '00010',
		2651 : '00010',
		2661 : '00010',
		2671 : '00010',
		2681 : '00010',
		2701 : '00010',
		2711 : '00010',
		2721 : '00010',
		2731 : '00010',
		2751 : '00010',
		2781 : '00010',
		2801 : '00010',
		2811 : '00010',
		2831 : '00010',
		2841 : '00010',
		2851 : '00010',
		2861 : '00010',
		2871 : '00010',
		2881 : '00010',
		2891 : '00010',
		2901 : '00010',
		2905 : '00010',
		2911 : '00010',
		2931 : '00010',
		2951 : '00010',
		2981 : '00010',
		2991 : '00010',
		3021 : '00010',
		3031 : '00010',
		3041 : '00010',
		3051 : '00010',
		3081 : '00010',
		3111 : '00010',
		3121 : '00010',
		3131 : '00010',
		3191 : '00010',
		3202 : '00010',
		3203 : '00010',
		3204 : '00010',
		3205 : '00010',
		3206 : '00010',
		3207 : '00010',
		3208 : '00010',
		3209 : '00010',
		3210 : '00010',
		3211 : '00010',
		3212 : '00010',
		3213 : '00010',
		3214 : '00010',
		3215 : '00010',
		3219 : '00010',
		3220 : '00010',
		3221 : '00010',
		3222 : '00010',
		3223 : '00010',
		3224 : '00010',
		3225 : '00010',
		3226 : '00010',
		3229 : '00010',
		3230 : '00010',
		3231 : '00010',
		3233 : '00010',
		3234 : '00010',
		3236 : '00010',
		3240 : '00010',
		3243 : '00010',
		3245 : '00010',
		3246 : '00010',
		3247 : '00010',
		3248 : '00010',
		3251 : '00010',
		3252 : '00010',
		3253 : '00010',
		3255 : '00010',
		3256 : '00010',
		3257 : '00010',
		3258 : '00010',
		3259 : '00010',
		3260 : '00010',
		3261 : '00010',
		3262 : '00010',
		3263 : '00010',
		3264 : '00010',
		3270 : '00010',
		3271 : '00010',
		3272 : '00010',
		3274 : '00010',
		3275 : '00010',
		3276 : '00010',
		3277 : '00010',
		3278 : '00010',
		3280 : '00010',
		3281 : '00010',
		3282 : '00010',
		3283 : '00010',
		3284 : '00010',
		3285 : '00010',
		3286 : '00010',
		3287 : '00010',
		3288 : '00010',
		3291 : '00010',
		3292 : '00010',
		3293 : '00010',
		3294 : '00010',
		3295 : '00010',
		3297 : '00010',
		3299 : '00010',
		3300 : '00010',
		3301 : '00010',
		3302 : '00010',
		3303 : '00010',
		3304 : '00010',
		3306 : '00010',
		3307 : '00010',
		3308 : '00010',
		3309 : '00010',
		3310 : '00010',
		3311 : '00010',
		3312 : '00010',
		3313 : '00010',
		3314 : '00010',
		3315 : '00010',
		3316 : '00010',
		3317 : '00010',
		3318 : '00010',
		3319 : '00010',
		3320 : '00010',
		3321 : '00010',
		3322 : '00010',
		3323 : '00010',
		3325 : '00010',
		3328 : '00010',
		3329 : '00010',
		3330 : '00010',
		3331 : '00010',
		3332 : '00010',
		3333 : '00010',
		3334 : '00010',
		3335 : '00010',
		3336 : '00010',
		3337 : '00010',
		3338 : '00010',
		3339 : '00010',
		3340 : '00010',
		3341 : '00010',
		3342 : '00010',
		3343 : '00010',
		3344 : '00010',
		3345 : '00010',
		3346 : '00010',
		3347 : '00010',
		3349 : '00010',
		3350 : '00010',
		3351 : '00010',
		3352 : '00010',
		3353 : '00010',
		3354 : '00010',
		3355 : '00010',
		3356 : '00010',
		3357 : '00010',
		3358 : '00010',
		3359 : '00010',
		3361 : '00010',
		3362 : '00010',
		3363 : '00010',
		3364 : '00010',
		3365 : '00010',
		3367 : '00010',
		3369 : '00010',
		3370 : '00010',
		3373 : '00010',
		3374 : '00010',
		3375 : '00010',
		3376 : '00010',
		3378 : '00010',
		3379 : '00010',
		3380 : '00010',
		3381 : '00010',
		3382 : '00010',
		3383 : '00010',
		3384 : '00010',
		3385 : '00010',
		3386 : '00010',
		3387 : '00010',
		3388 : '00010',
		3389 : '00010',
		3391 : '00010',
		3392 : '00010',
		3393 : '00010',
		3394 : '00010',
		3395 : '00010',
		3396 : '00010',
		3398 : '00010',
		3399 : '00010',
		3400 : '00010',
		3401 : '00010',
		3402 : '00010',
		3403 : '00010',
		3404 : '00010',
		3405 : '00010',
		3406 : '00010',
		3407 : '00010',
		3408 : '00010',
		3410 : '00010',
		3411 : '00010',
		3412 : '00010',
		3413 : '00010',
		3414 : '00010',
		3415 : '00010',
		3416 : '00010',
		3417 : '00010',
		3418 : '00010',
		3419 : '00010',
		3420 : '00010',
		3421 : '00010',
		3422 : '00010',
		3423 : '00010',
		3424 : '00010',
		3425 : '00010',
		3426 : '00010',
		3427 : '00010',
		3428 : '00010',
		3429 : '00010',
		3430 : '00010',
		3433 : '00010',
		3434 : '00010',
		3435 : '00010',
		3436 : '00010',
		3437 : '00010',
		3438 : '00010',
		3439 : '00010',
		3440 : '00010',
		3441 : '00010',
		3442 : '00010',
		3443 : '00010',
		3444 : '00010',
		3445 : '00010',
		3446 : '00010',
		3450 : '00010',
		3451 : '00010',
		3452 : '00010',
		3453 : '00010',
		3454 : '00010',
		3455 : '00010',
		3456 : '00010',
		3457 : '00010',
		3458 : '00010',
		3459 : '00010',
		3460 : '00010',
		4104 : '00010',
		4010 : '00081',
		4011 : '00081',
		4012 : '00081',
		4013 : '00081',
		4014 : '00081',
		4015 : '00081',
		4016 : '00081',
		4017 : '00081',
		4018 : '00081',
		4019 : '00081',
		4020 : '00081',
		4021 : '00081',
		4022 : '00081',
		4023 : '00081',
		4024 : '00081',
		4025 : '00081',
		4026 : '00081',
		4027 : '00081',
		4028 : '00081',
		4029 : '00081',
		4030 : '00081',
		4031 : '00081',
		4032 : '00081',
		4033 : '00081',
		4034 : '00081',
		4035 : '00081',
		4036 : '00081',
		4037 : '00081',
		4038 : '00081',
		4039 : '00081',
		4040 : '00081',
		5010 : '00020',
		5020 : '00020',
		5110 : '00025',
		5112 : '00025',
		5113 : '00025',
		5120 : '00025',
		5130 : '00025',
		5140 : '00025',
		5160 : '00025',
		5170 : '00025',
		5180 : '00025',
		5190 : '00025',
		5191 : '00025',
		5192 : '00025',
		5193 : '00025',
		5194 : '00025',
		5196 : '00025',
		5210 : '00012',
		5211 : '00012',
		5212 : '00012',
		5213 : '00012',
		5214 : '00012',
		5215 : '00012',
		6001 : '00018',
		6536 : '00011'
	};

	// This translates the site code to the company code which will be used in column VNKCO.
	// If the value is not translated the original value unmapped is returned so we know which one caused it.
	function getSiteCodeToCompanyCode (strSiteCode)
	{
		var strCompanyCode = mapSiteCodeToCompanyCode[Number(strSiteCode)];
		if (strCompanyCode == null)
		{
			strCompanyCode = '';
		}
		return strCompanyCode;
	}
	]]></msxsl:script>	
</xsl:stylesheet>
