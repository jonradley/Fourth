<?xml version="1.0" encoding="UTF-8"?>
<!--**************************************************************************************
 Overview

	Fairfax Meadow's csv delivery note format

******************************************************************************************
 Module History
******************************************************************************************
 Date         | Name       		| Description of modification
******************************************************************************************
     ?       	|       ?       	| Created
******************************************************************************************
 30/03/2012		| H Robson	 	| 5541 handle CSV correctly, ensure field totals are correct in ffs
******************************************************************************************
 15/08/2012   	| H Robson	 	| 5602 set ffsRecordSeparator to CrLf to match format of inbound files
***************************************************************************************-->
<ffsFlatFileSchema>
	<ffsSettings>
		<ffsRecordPositionType>named</ffsRecordPositionType>
		<ffsRecordSeparator>chr(13)chr(10)</ffsRecordSeparator>
		<ffsFieldSeparators>
			<ffsFieldSeparator>,</ffsFieldSeparator>
		</ffsFieldSeparators>
		<ffsPadding/>
		<ffsGroups>
			<ffsGroup>
				<!--References below which MEAN RecordPos 'H' with LPos 1 would be CODED as 'D' and LPos 14 (13+1)-->
				<ffsGroupRecord RecordPos="HEAD" FieldTotal="40"/>
				<ffsSubGroupRecord RecordPos="LINE" FieldTotal="40"/>
			</ffsGroup>
		</ffsGroups>
		<ffsSplitBatchRecord RecordPos="HEAD"/>
	</ffsSettings>
	<ffsRoot>
		<Batch>
			<BatchHeader>
				<!--MHDSegment>
					<MHDHeader RecordPos="TRANTYPE" LPos="3"/>
					<MHDVersion  RecordPos="TRANTYPE" LPos="2"/>
				</MHDSegment-->
				<!--VATSubTotals>
					<VATSubTotal-->
				<!-- MANDATORY VATTLR - VRS - VSDE (File sub-total amount excluding discount) -->
				<!--DocumentTotalExclVATAtRate RecordPos="VATSUMMARY" LPos="4"/-->
				<!-- MANDATORY VATTLR - VRS - VSDI (File sub total amount including discount) -->
				<!--SettlementTotalExclVATAtRate RecordPos="VATSUMMARY" LPos="5"/-->
				<!-- MANDATORY VATTLR - VRS - VVAT (File VAT sub-total)-->
				<!--VATAmountAtRate RecordPos="VATSUMMARY" LPos="6"/-->
				<!-- MANDATORY VATTLR - VRS - VPSE (File sub-total payable excluding discount) [ unless blank, then use VPSI ]-->
				<!--DocumentTotalInclVATAtRate RecordPos="VATSUMMARY" LPos="8"/-->
				<!-- MANDATORY VATTLR - VRS - VPSI (File sub-total payable including discount) -->
				<!--SettlementTotalInclVATAtRate RecordPos="VATSUMMARY" LPos="8"/-->
				<!--ffsAttribute1 name="VATCode" RecordPos="VATSUMMARY" LPos="2"/-->
				<!--ffsAttribute1 name="VATRate" RecordPos="VATSUMMARY" LPos="3"/-->
				<!--/VATSubTotal>
				</VATSubTotals-->
				<!-- MANDATORY INVTLR - TOT - FASE (File total amount ex VAT ex discount) -->
				<!--DocumentTotalExclVAT RecordPos="INVTOTALS" LPos="3"/-->
				<!-- MANDATORY INVTLR - TOT - FASI (File total amount ex VAT inc discount) -->
				<!--SettlementTotalExclVAT RecordPos="INVTOTALS" LPos="3"/-->
				<!-- MANDATORY INVTLR - TOT - FVAT (File total VAT) -->
				<!--VATAmount RecordPos="INVTOTALS" LPos="4"/-->
				<!-- MANDATORY INVTLR - TOT - FPSE (File total payable ex discount) -->
				<!--DocumentTotalInclVAT RecordPos="INVTOTALS" LPos="5"/-->
				<!-- MANDATORY INVTLR - TOT - FPSI (File total payable inc discount) -->
				<!--SettlementTotalInclVAT RecordPos="INVTOTALS" LPos="6"/-->
			</BatchHeader>
			<BatchDocuments>
				<BatchDocument>
					<Invoice>
						<TradeSimpleHeader>
							<SendersCodeForRecipient RecordPos="HEAD" LPos="4"/>
							<SendersBranchReference RecordPos="HEAD" LPos="40"/>
						</TradeSimpleHeader>
						<InvoiceHeader>
							<Buyer>
								<BuyersLocationID>
									<SuppliersCode RecordPos="HEAD" LPos="3"/>
								</BuyersLocationID>
								<!--BuyersName RecordPos="HEAD" LPos="17"/-->
								<!--BuyersAddress>
									<AddressLine1 RecordPos="CUSTOMER" LPos="4"/>
									<AddressLine2 RecordPos="CUSTOMER" LPos="5"/>
									<AddressLine3 RecordPos="CUSTOMER" LPos="6"/>
									<AddressLine4 RecordPos="CUSTOMER" LPos="7"/>
									<PostCode RecordPos="CUSTOMER" LPos="8"/>
								</BuyersAddress-->
							</Buyer>
							<!--Supplier-->
							<!--SuppliersLocationID>
									<SuppliersCode RecordPos="" LPos=""/>
								</SuppliersLocationID-->
							<!--SuppliersName RecordPos="SUPPLIER" LPos="3"/>
								<SuppliersAddress>
									<AddressLine1 RecordPos="SUPPLIER" LPos="4"/>
									<AddressLine2 RecordPos="SUPPLIER" LPos="5"/>
									<AddressLine3 RecordPos="SUPPLIER" LPos="6"/>
									<AddressLine4 RecordPos="SUPPLIER" LPos="7"/>
									<PostCode RecordPos="SUPPLIER" LPos="8"/>
								</SuppliersAddress>
							</Supplier-->
							<ShipTo>
								<ShipToLocationID>
									<BuyersCode RecordPos="HEAD" LPos="24"/>
									<SuppliersCode RecordPos="HEAD" LPos="4"/>
								</ShipToLocationID>
								<!--ShipToName RecordPos="HEAD" LPos="17"/-->
								<!--ShipToAddress>
									<AddressLine1 RecordPos="INVHDR" LPos="4"/>
									<AddressLine2 RecordPos="INVHDR" LPos="5"/>
									<AddressLine3 RecordPos="INVHDR" LPos="6"/>
									<AddressLine4 RecordPos="INVHDR" LPos="7"/>
									<PostCode RecordPos="INVHDR" LPos="8"/>
								</ShipToAddress-->
							</ShipTo>
							<InvoiceReferences>
								<InvoiceReference RecordPos="HEAD" LPos="5"/>
								<InvoiceDate RecordPos="HEAD" LPos="6"/>
								<TaxPointDate RecordPos="HEAD" LPos="6"/>
								<!--VATRegNo RecordPos="SUPPLIER" LPos="12"/-->
							</InvoiceReferences>
							<!--Currency RecordPos="SUPPLIER" LPos="11"/-->
							<!-- Hijacked for Payment Due Date -->
							<SequenceNumber RecordPos="HEAD" LPos="15"/>
						</InvoiceHeader>
						<InvoiceDetail>
							<InvoiceLine>
								<!--<LineNumber RecordPos="" LPos=""/>-->
								<PurchaseOrderReferences>
									<PurchaseOrderReference RecordPos="LINE" LPos="47"/>
									<PurchaseOrderDate RecordPos="LINE" LPos="48"/>
									<TradeAgreement>
										<ContractReference RecordPos="LINE" LPos="80"/>
									</TradeAgreement>
								</PurchaseOrderReferences>
								<DeliveryNoteReferences>
									<DeliveryNoteReference RecordPos="LINE" LPos="51"/>
									<!-- use invoice date, dn date is wrong. -->
									<DeliveryNoteDate RecordPos="LINE" LPos="46"/>
								</DeliveryNoteReferences>
								<ProductID>
									<SuppliersProductCode RecordPos="LINE" LPos="2"/>
								</ProductID>
								<ProductDescription RecordPos="LINE" LPos="25"/>
								<!-- Hijacked to overcome a weirdness in the inbound file with qtys -->
								<OrderedQuantity RecordPos="LINE" LPos="7"/>
								<InvoicedQuantity RecordPos="LINE" LPos="8">
									<ffsAttribute1 name="UnitOfMeasure" RecordPos="LINE" LPos="6"/>
								</InvoicedQuantity>
								<PackSize RecordPos="LINE" LPos="40"/>
								<UnitValueExclVAT RecordPos="LINE" LPos="10"/>
								<LineValueExclVAT RecordPos="LINE" LPos="15"/>
								<VATCode RecordPos="LINE" LPos="14"/>
								<!--VATRate RecordPos="LINE" LPos="12"/-->
								<!-- TBC -->
								<!--Measure>
									<UnitsInPack RecordPos="INVDETS" LPos="14"/>
								</Measure-->
							</InvoiceLine>
						</InvoiceDetail>
						<InvoiceTrailer>
							<!-- TBC -->
							<!--NumberOfLines RecordPos="H" LPos="27"/-->
							<!--NumberOfItems RecordPos="H" LPos="28"/-->
							<!--NumberOfDeliveries RecordPos="H" LPos="26"/-->
							<!--VATSubTotals-->
							<!--VATSubTotal-->
							<!--NumberOfLinesAtRate RecordPos="VAT" LPos="3"/-->
							<!--NumberOfItemsAtRate RecordPos="V" LPos="5"/-->
							<!--DocumentTotalExclVATAtRate RecordPos="VAT" LPos="5"/-->
							<!--SettlementDiscountAtRate RecordPos="VATSUBTLR" LPos="6"/-->
							<!--SettlementTotalExclVATAtRate RecordPos="VATSUBTLR" LPos="12"/-->
							<!--VATAmountAtRate RecordPos="VAT" LPos="7"/-->
							<!--DocumentTotalInclVATAtRate RecordPos="VAT" LPos="5"/-->
							<!--SettlementTotalInclVATAtRate RecordPos="VAT" LPos="6"/-->
							<!--ffsAttribute1 name="VATCode" RecordPos="VAT" LPos="2"/-->
							<!--ffsAttribute1 name="VATRate" RecordPos="VAT" LPos="10"/-->
							<!--/VATSubTotal-->
							<!--/VATSubTotals-->
							<DocumentTotalExclVAT RecordPos="TRAIL" LPos="2"/>
							<!--SettlementDiscount RecordPos="TRAIL" LPos="6"/-->
							<!--SettlementTotalExclVAT RecordPos="TRAIL" LPos="2"/-->
							<VATAmount RecordPos="TRAIL" LPos="7"/>
							<DocumentTotalInclVAT RecordPos="TRAIL" LPos="9"/>
							<!--SettlementTotalInclVAT RecordPos="TRAIL" LPos="9"/-->
						</InvoiceTrailer>
					</Invoice>
					<!--ffsAttribute1 name="DocumentTypeNo" RecordPos="MAGINUSINV" LPos="1"/-->
				</BatchDocument>
			</BatchDocuments>
		</Batch>
	</ffsRoot>
</ffsFlatFileSchema>
